<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Intro to Tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="intro_to_tidyverse_files/libs/clipboard/clipboard.min.js"></script>
<script src="intro_to_tidyverse_files/libs/quarto-html/quarto.js"></script>
<script src="intro_to_tidyverse_files/libs/quarto-html/popper.min.js"></script>
<script src="intro_to_tidyverse_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="intro_to_tidyverse_files/libs/quarto-html/anchor.min.js"></script>
<link href="intro_to_tidyverse_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="intro_to_tidyverse_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="intro_to_tidyverse_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="intro_to_tidyverse_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="intro_to_tidyverse_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-wrangling-with-r" id="toc-data-wrangling-with-r" class="nav-link active" data-scroll-target="#data-wrangling-with-r">Data Wrangling with R</a>
  <ul class="collapse">
  <li><a href="#setting-up-loading-the-tidyverse-packages" id="toc-setting-up-loading-the-tidyverse-packages" class="nav-link" data-scroll-target="#setting-up-loading-the-tidyverse-packages">0. Setting Up: Loading the tidyverse packages</a></li>
  <li><a href="#tidy-data" id="toc-tidy-data" class="nav-link" data-scroll-target="#tidy-data">1. (Tidy) Data</a></li>
  <li><a href="#some-coding-basics" id="toc-some-coding-basics" class="nav-link" data-scroll-target="#some-coding-basics">2. Some coding basics</a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#pipes" id="toc-pipes" class="nav-link" data-scroll-target="#pipes">Pipes</a></li>
  </ul></li>
  <li><a href="#working-with-data-some-key-tidyverse-verbs" id="toc-working-with-data-some-key-tidyverse-verbs" class="nav-link" data-scroll-target="#working-with-data-some-key-tidyverse-verbs">3. Working with Data: Some key tidyverse verbs</a>
  <ul class="collapse">
  <li><a href="#pull" id="toc-pull" class="nav-link" data-scroll-target="#pull">Pull</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">Filter</a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate">Mutate</a></li>
  <li><a href="#summarize" id="toc-summarize" class="nav-link" data-scroll-target="#summarize">Summarize</a></li>
  <li><a href="#grouping-and-summarizing" id="toc-grouping-and-summarizing" class="nav-link" data-scroll-target="#grouping-and-summarizing">Grouping and summarizing</a></li>
  <li><a href="#finale" id="toc-finale" class="nav-link" data-scroll-target="#finale">Finale</a></li>
  </ul></li>
  <li><a href="#working-with-experiment-data" id="toc-working-with-experiment-data" class="nav-link" data-scroll-target="#working-with-experiment-data">4. Working with Experiment Data</a>
  <ul class="collapse">
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data">4.1. Load the data</a></li>
  <li><a href="#understand-the-structure-of-the-data" id="toc-understand-the-structure-of-the-data" class="nav-link" data-scroll-target="#understand-the-structure-of-the-data">4.2. Understand the structure of the data</a></li>
  <li><a href="#summarize-the-data-from-experiment-1a" id="toc-summarize-the-data-from-experiment-1a" class="nav-link" data-scroll-target="#summarize-the-data-from-experiment-1a">4.3. Summarize the data from Experiment 1A</a></li>
  <li><a href="#plot-the-data" id="toc-plot-the-data" class="nav-link" data-scroll-target="#plot-the-data">4.4. Plot the data</a></li>
  <li><a href="#more-advanced-summarizing" id="toc-more-advanced-summarizing" class="nav-link" data-scroll-target="#more-advanced-summarizing">4.5. More advanced summarizing</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Intro to Tidyverse</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="data-wrangling-with-r" class="level1">
<h1>Data Wrangling with R</h1>
<p>Today’s goal is to get familiar with some of the basics of working with data using R’s <a href="https://www.tidyverse.org/">tidyverse</a> environment.</p>
<p>Tidyverse is a set of packages written for the statistical software R that is optimized for data science.</p>
<p>There are many components to the tidyverse, but we will focus on three packages in particular:</p>
<ul>
<li><p>Getting data into “tidy” format using <code>tidyr</code></p></li>
<li><p>Manipulating or “wrangling” data for analysis using <code>dplyr</code></p></li>
<li><p>Visualizing data using <code>ggplot2</code></p></li>
</ul>
<p>The overarching goal is to give you the basic tools for data exploration and visualization as quickly as possible.</p>
<p>The workflow and philosophy of how this works is captured in this figure from the excellent <a href="https://r4ds.hadley.nz/">R for Data Science</a> book by Hadley Wickham (the main author of the tidyverse packages).</p>
<p>The goal of these packages is to give you the tools to:</p>
<ul>
<li><p><strong>import</strong> your data for analysis</p></li>
<li><p>bring the data into a standard, consistent, <strong>tidy</strong> format</p></li>
<li><p><strong>transform</strong> the data according to your analysis needs</p></li>
<li><p><strong>visualize</strong> the data in the service of understanding it</p></li>
</ul>
<p><img src="images/data-science-explore.png" class="img-fluid"></p>
<p>Before beginning this tutorial, make sure to download R and RStudio.</p>
<section id="setting-up-loading-the-tidyverse-packages" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-loading-the-tidyverse-packages">0. Setting Up: Loading the tidyverse packages</h2>
<p>This first part of the code just installs and loads the R packages we want to use for the following analyses.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Install packages we want to use</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#specify the name of all packages we want to use her</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("palmerpenguins")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#load packages we want to use</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set some basic plotting defaults</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#check the version of R used</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(R.version.string)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "R version 4.3.2 (2023-10-31)"</code></pre>
</div>
</div>
</section>
<section id="tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="tidy-data">1. (Tidy) Data</h2>
<p>Here’s the basic idea behind “tidy” data.</p>
<p>In “tidy” data,…</p>
<p>… every row is a <strong>single observation</strong> (e.g., a trial in experiments)</p>
<p>… every column is a <strong>variable</strong> with a <strong>value</strong> describing that observation</p>
<p><img src="images/tidy-1.png" class="img-fluid"></p>
<p>For this first introduction, we will use Allison Horst’s <code>palmerpenguins</code> dataset: https://allisonhorst.github.io/palmerpenguins/</p>
<p>The dataset contains information about 344 penguins, from 3 different species of penguins that live on 3 islands in the Palmer Archipelago, Antarctica.</p>
<p>Here’s a cute drawing of the three penguin species: Chinstrap, Gentoo and Adelie!</p>
<p>Let’s load the data and take a peek!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 8
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
<p>That’s a lot of data! To get a more manageable peek, you can use glimpse()</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 344
Columns: 8
$ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
$ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
$ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
$ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
$ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
$ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
$ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
</div>
<p>Each row in the data represents the data from one penguin on one of the 3 islands. Let’s think about what each of our columns means.</p>
<ul>
<li><strong>species</strong>: the species that the penguin belongs to (Chinstrap, Gentoo and Adelie)</li>
<li><strong>island</strong>: the island that the penguin lives on (Biscoe, Dream, Torgersen)</li>
<li>information about the penguins’ general size and dimensions:
<ul>
<li><strong>bill_length_mm</strong>: bill length in mm</li>
<li><strong>bill_depth_mm</strong>: bill depth in mm</li>
<li><strong>flipper_length_mm</strong>: flipper length in mm</li>
<li><strong>body_mass_g</strong>: body mass in grams</li>
</ul></li>
<li><strong>sex</strong>: the sex of the penguin</li>
<li><strong>year</strong>: the year the penguin was observed</li>
</ul>
<p>This data is in tidy format!</p>
<p>… every row corresponds to a single observation (of a penguin)</p>
<p>… each column is a variable with a single value for each observation (penguin)</p>
<p>One useful tip: an easy way to access individual columns in a data frame (or “tibble”) is to use the $ character. So, for example, to access all of the bill lengths we can do penguins$bill_length_mm</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#access the bill length column</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>bill_depth_mm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 18.7 17.4 18.0   NA 19.3 20.6 17.8 19.6 18.1 20.2 17.1 17.3 17.6 21.2 21.1
 [16] 17.8 19.0 20.7 18.4 21.5 18.3 18.7 19.2 18.1 17.2 18.9 18.6 17.9 18.6 18.9
 [31] 16.7 18.1 17.8 18.9 17.0 21.1 20.0 18.5 19.3 19.1 18.0 18.4 18.5 19.7 16.9
 [46] 18.8 19.0 18.9 17.9 21.2 17.7 18.9 17.9 19.5 18.1 18.6 17.5 18.8 16.6 19.1
 [61] 16.9 21.1 17.0 18.2 17.1 18.0 16.2 19.1 16.6 19.4 19.0 18.4 17.2 18.9 17.5
 [76] 18.5 16.8 19.4 16.1 19.1 17.2 17.6 18.8 19.4 17.8 20.3 19.5 18.6 19.2 18.8
 [91] 18.0 18.1 17.1 18.1 17.3 18.9 18.6 18.5 16.1 18.5 17.9 20.0 16.0 20.0 18.6
[106] 18.9 17.2 20.0 17.0 19.0 16.5 20.3 17.7 19.5 20.7 18.3 17.0 20.5 17.0 18.6
[121] 17.2 19.8 17.0 18.5 15.9 19.0 17.6 18.3 17.1 18.0 17.9 19.2 18.5 18.5 17.6
[136] 17.5 17.5 20.1 16.5 17.9 17.1 17.2 15.5 17.0 16.8 18.7 18.6 18.4 17.8 18.1
[151] 17.1 18.5 13.2 16.3 14.1 15.2 14.5 13.5 14.6 15.3 13.4 15.4 13.7 16.1 13.7
[166] 14.6 14.6 15.7 13.5 15.2 14.5 15.1 14.3 14.5 14.5 15.8 13.1 15.1 14.3 15.0
[181] 14.3 15.3 15.3 14.2 14.5 17.0 14.8 16.3 13.7 17.3 13.6 15.7 13.7 16.0 13.7
[196] 15.0 15.9 13.9 13.9 15.9 13.3 15.8 14.2 14.1 14.4 15.0 14.4 15.4 13.9 15.0
[211] 14.5 15.3 13.8 14.9 13.9 15.7 14.2 16.8 14.4 16.2 14.2 15.0 15.0 15.6 15.6
[226] 14.8 15.0 16.0 14.2 16.3 13.8 16.4 14.5 15.6 14.6 15.9 13.8 17.3 14.4 14.2
[241] 14.0 17.0 15.0 17.1 14.5 16.1 14.7 15.7 15.8 14.6 14.4 16.5 15.0 17.0 15.5
[256] 15.0 13.8 16.1 14.7 15.8 14.0 15.1 15.2 15.9 15.2 16.3 14.1 16.0 15.7 16.2
[271] 13.7   NA 14.3 15.7 14.8 16.1 17.9 19.5 19.2 18.7 19.8 17.8 18.2 18.2 18.9
[286] 19.9 17.8 20.3 17.3 18.1 17.1 19.6 20.0 17.8 18.6 18.2 17.3 17.5 16.6 19.4
[301] 17.9 19.0 18.4 19.0 17.8 20.0 16.6 20.8 16.7 18.8 18.6 16.8 18.3 20.7 16.6
[316] 19.9 19.5 17.5 19.1 17.0 17.9 18.5 17.9 19.6 18.7 17.3 16.4 19.0 17.3 19.7
[331] 17.3 18.8 16.6 19.9 18.8 19.4 19.5 16.5 17.0 19.8 18.1 18.2 19.0 18.7</code></pre>
</div>
</div>
<p>To get a little bit excited, let’s start out by diving right into visualization to flex our new powers. Don’t worry too much about the details just yet. We’ll explain some of the basics in more depth over the next few sessions. This is just to get a quick sense of why it might be cool to learn more about working with data in R.</p>
<p>Let’s say I want to do a scatterplot of bill length by bill depth. Creating that plot using ggplot in R is as simple as the following:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the ggplot call sets up the basic structure of the graph</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># first, we specify the dataset we want to use</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># then, we specify the key "aesthetics" with aes:</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># what's on x-axis? what's on the y-axis?</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># different "geoms" define what type of structure we plot. In this case, we use geom_point() to plot individual dots for each observation</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interesting!! Now, I know there are three species of penguin. Are there any systematicities in bill length and bill depth across them? To see, let’s try to highlight the color of the dots for each species.</p>
<p><strong>Advanced:</strong> Why do you think we’re getting the warning message we see?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add color, defined by the species column, to the aes() call</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color=</span>species)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ooooh, now I see that there’s something systematic happening here. Let’s put some final touches on this graph so that it looks a bit better: * Change the color scheme to something more attractive * rename the axes for humans</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot example: penguin bill length versus bill depth</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color=</span>species)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change colors manually</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkorange"</span>,<span class="st">"darkorchid"</span>,<span class="st">"cyan4"</span>))<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename axes</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Bill Length (in mm)"</span>)<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Bill Depth (in mm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="some-coding-basics" class="level2">
<h2 class="anchored" data-anchor-id="some-coding-basics">2. Some coding basics</h2>
<p>To get warmed up, let’s get familiar with two key concepts in R:</p>
<ul>
<li>functions</li>
<li>pipes</li>
</ul>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<p>We’ll start with the concept of a function.</p>
<p>Just like in other programming languages, a function is a way to <strong>do</strong> something to a data object. It takes an argument (or a series of arguments) and returns a value.</p>
<p>A nice example in R is <code>mean()</code>. <code>mean()</code> takes an argument, a numeric vector, and returns the average. <code>mean()</code> also has a second argument, <code>na.rm=TRUE</code>, that can tell it to ignore missing values (this is useful in our penguins dataset).</p>
<p>So, to compute the average bill depth, we can write the following code:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average bill depth</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(penguins<span class="sc">$</span>bill_depth_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.15117</code></pre>
</div>
</div>
<p>Hmm, that’s a lot of decimal places… It would be nice to clean this up a bit by rounding off after a few decimals. Conveniently, R provides a <code>round()</code> function that does just that! (it takes a second argument, digits, that tells it how many decimal places to round to).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#round the average value</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(penguins<span class="sc">$</span>bill_depth_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.15</code></pre>
</div>
</div>
<p>While it’s nice to be able to strong functions together this way, that line is already looking kind of complicated. Is there an easier way to apply functions sequentially, one after the other? We’ll return to this in a moment.</p>
<p>R supplies all sorts of functions that are useful for data analysis. For example, see if you can figure out how heavy the chonkiest penguin is.</p>
<p><strong>Tip</strong>: The function for the finding the maximum value of a list/vector in R is <code>max()</code></p>
<p><strong>Tip #2</strong>: If you run into missing values, you can ignore them using the parameter <code>na.rm=TRUE</code>. So <code>max(my_vector,na.rm=TRUE)</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Find the maximum weight in the body_mass_g column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="pipes" class="level3">
<h3 class="anchored" data-anchor-id="pipes">Pipes</h3>
<p>We already noticed that the code starts to look complicated once we have to start nesting functions, e.g.&nbsp;<code>round(mean(penguins$bill_depth_mm,na.rm=TRUE),digits=2)</code>. This is pretty hard to read and figure out what’s going on!</p>
<p>This motivates the intuition behind why a <strong>pipe</strong> operator <code>|&gt;</code> (or alternatively <code>%&gt;%</code>) is useful.</p>
<p>Pipes are just a way of bringing the main argument we supply to a function to the front of the operation. For example, to compute the mean of bill depth, we can write the following instead, using the pipe operator:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the mean using a pipe</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>bill_depth_mm <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.15117</code></pre>
</div>
</div>
<p>This allows us to string functions together - basic as many as we want - in the order that we would like to do them. What’s nice about this is that it makes the code much more legible, and it allows us to write the code in their intuitive order.</p>
<p>For example, rather than having to write the nested code above, where the <code>mean()</code> function is nested within the <code>round()</code> function, we can use the pipe operator to write the sequence of operations out in order, for much cleaner code - we can just read off the sequence of actions we’re performing, in order!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>bill_depth_mm <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.15</code></pre>
</div>
</div>
</section>
</section>
<section id="working-with-data-some-key-tidyverse-verbs" class="level2">
<h2 class="anchored" data-anchor-id="working-with-data-some-key-tidyverse-verbs">3. Working with Data: Some key tidyverse verbs</h2>
<p>In this section, we’re going to become familiar with some of the key tidyverse “verbs”: tidyverse functions for quickly and easily manipulating (“wrangling”) data.</p>
<p>There are many of these functions, but for know, we’ll get to know the following key verbs:</p>
<ul>
<li><code>pull()</code></li>
<li><code>filter()</code></li>
<li><code>mutate()</code></li>
<li><code>summarize()</code></li>
<li><code>group_by()</code></li>
</ul>
<p><strong>NOTE:</strong> Tidyverse functions often have very intuitive names, but always be sure to check and make sure you understand what they do by reading the documentation!</p>
<p>You can always get help on a given function by typing <code>?function_name</code> (e.g., <code>?pull</code>).</p>
<section id="pull" class="level3">
<h3 class="anchored" data-anchor-id="pull">Pull</h3>
<p>Let’s get to know our first verb: <code>pull()</code>.</p>
<p>See its documentation <a href="https://dplyr.tidyverse.org/reference/pull.html">here</a>.</p>
<p>This verb allows us to “pull” the data from specific columns in our dataset - so it provides an alternative to using the <code>$</code> operator. So, an alternative way to access a column in the penguins dataset is given below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#first, read more about pull</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>?pull</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#now, pull data from the bill depth column</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_depth_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 18.7 17.4 18.0   NA 19.3 20.6 17.8 19.6 18.1 20.2 17.1 17.3 17.6 21.2 21.1
 [16] 17.8 19.0 20.7 18.4 21.5 18.3 18.7 19.2 18.1 17.2 18.9 18.6 17.9 18.6 18.9
 [31] 16.7 18.1 17.8 18.9 17.0 21.1 20.0 18.5 19.3 19.1 18.0 18.4 18.5 19.7 16.9
 [46] 18.8 19.0 18.9 17.9 21.2 17.7 18.9 17.9 19.5 18.1 18.6 17.5 18.8 16.6 19.1
 [61] 16.9 21.1 17.0 18.2 17.1 18.0 16.2 19.1 16.6 19.4 19.0 18.4 17.2 18.9 17.5
 [76] 18.5 16.8 19.4 16.1 19.1 17.2 17.6 18.8 19.4 17.8 20.3 19.5 18.6 19.2 18.8
 [91] 18.0 18.1 17.1 18.1 17.3 18.9 18.6 18.5 16.1 18.5 17.9 20.0 16.0 20.0 18.6
[106] 18.9 17.2 20.0 17.0 19.0 16.5 20.3 17.7 19.5 20.7 18.3 17.0 20.5 17.0 18.6
[121] 17.2 19.8 17.0 18.5 15.9 19.0 17.6 18.3 17.1 18.0 17.9 19.2 18.5 18.5 17.6
[136] 17.5 17.5 20.1 16.5 17.9 17.1 17.2 15.5 17.0 16.8 18.7 18.6 18.4 17.8 18.1
[151] 17.1 18.5 13.2 16.3 14.1 15.2 14.5 13.5 14.6 15.3 13.4 15.4 13.7 16.1 13.7
[166] 14.6 14.6 15.7 13.5 15.2 14.5 15.1 14.3 14.5 14.5 15.8 13.1 15.1 14.3 15.0
[181] 14.3 15.3 15.3 14.2 14.5 17.0 14.8 16.3 13.7 17.3 13.6 15.7 13.7 16.0 13.7
[196] 15.0 15.9 13.9 13.9 15.9 13.3 15.8 14.2 14.1 14.4 15.0 14.4 15.4 13.9 15.0
[211] 14.5 15.3 13.8 14.9 13.9 15.7 14.2 16.8 14.4 16.2 14.2 15.0 15.0 15.6 15.6
[226] 14.8 15.0 16.0 14.2 16.3 13.8 16.4 14.5 15.6 14.6 15.9 13.8 17.3 14.4 14.2
[241] 14.0 17.0 15.0 17.1 14.5 16.1 14.7 15.7 15.8 14.6 14.4 16.5 15.0 17.0 15.5
[256] 15.0 13.8 16.1 14.7 15.8 14.0 15.1 15.2 15.9 15.2 16.3 14.1 16.0 15.7 16.2
[271] 13.7   NA 14.3 15.7 14.8 16.1 17.9 19.5 19.2 18.7 19.8 17.8 18.2 18.2 18.9
[286] 19.9 17.8 20.3 17.3 18.1 17.1 19.6 20.0 17.8 18.6 18.2 17.3 17.5 16.6 19.4
[301] 17.9 19.0 18.4 19.0 17.8 20.0 16.6 20.8 16.7 18.8 18.6 16.8 18.3 20.7 16.6
[316] 19.9 19.5 17.5 19.1 17.0 17.9 18.5 17.9 19.6 18.7 17.3 16.4 19.0 17.3 19.7
[331] 17.3 18.8 16.6 19.9 18.8 19.4 19.5 16.5 17.0 19.8 18.1 18.2 19.0 18.7</code></pre>
</div>
</div>
<p>Note that we can now rewrite the code above computing the (rounded) mean to go “full tidyverse”, using only tidyverse functions and concatenating the functions using the pipe operator. Can you figure out how?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#take the penguin dataset</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">#pull the bill depth column</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the mean, and</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#round to 2 decimal places</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_depth_mm) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.15</code></pre>
</div>
</div>
</section>
<section id="filter" class="level3">
<h3 class="anchored" data-anchor-id="filter">Filter</h3>
<p>OK, let’s learn something new.</p>
<p>There are lots of reasons you might want to remove rows from your dataset, including getting rid of outliers, selecting subpopulations, and so forth. For this purpose, <code>filter()</code> is a verb (a function in the tidyverse) that takes a data frame as its first argument, and then as its other argument(s) takes the condition(s) you want to filter on.</p>
<p>For example, if we want to just look at the data for those cute Chinstrap penguins, we can do</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Chinstrap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 8
   species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Chinstrap Dream            46.5          17.9               192        3500
 2 Chinstrap Dream            50            19.5               196        3900
 3 Chinstrap Dream            51.3          19.2               193        3650
 4 Chinstrap Dream            45.4          18.7               188        3525
 5 Chinstrap Dream            52.7          19.8               197        3725
 6 Chinstrap Dream            45.2          17.8               198        3950
 7 Chinstrap Dream            46.1          18.2               178        3250
 8 Chinstrap Dream            51.3          18.2               197        3750
 9 Chinstrap Dream            46            18.9               195        4150
10 Chinstrap Dream            51.3          19.9               198        3700
# ℹ 58 more rows
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
<p>We can also specify multiple filtering conditions. For example, if we wanted to look at only the Chinstrap penguins that weigh more than 4000g, we could write:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#select only Chinstrap penguins &gt; 4000g</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Chinstrap"</span>,body_mass_g<span class="sc">&gt;</span><span class="dv">4000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 8
   species   island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Chinstrap Dream            46            18.9               195        4150
 2 Chinstrap Dream            52            18.1               201        4050
 3 Chinstrap Dream            50.5          19.6               201        4050
 4 Chinstrap Dream            49.2          18.2               195        4400
 5 Chinstrap Dream            52            19                 197        4150
 6 Chinstrap Dream            52.8          20                 205        4550
 7 Chinstrap Dream            54.2          20.8               201        4300
 8 Chinstrap Dream            51            18.8               203        4100
 9 Chinstrap Dream            52            20.7               210        4800
10 Chinstrap Dream            53.5          19.9               205        4500
11 Chinstrap Dream            50.8          18.5               201        4450
12 Chinstrap Dream            49            19.6               212        4300
13 Chinstrap Dream            50.7          19.7               203        4050
14 Chinstrap Dream            49.3          19.9               203        4050
15 Chinstrap Dream            50.8          19                 210        4100
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
<p>Mini exercises:</p>
<ol type="1">
<li>Can you filter the data to all of the male Gentoo penguins?</li>
<li>Can you compute the average bill length of Adelie penguins?</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter to only male Gentoo penguins</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average bill length of Adelie penguins</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mutate" class="level3">
<h3 class="anchored" data-anchor-id="mutate">Mutate</h3>
<p>Adding columns to data frames is usually done to compute some kind of derived variable. <code>mutate()</code> is the verb for these situations – it allows you to add a column to your dataset (or change one that already exists).</p>
<p><code>mutate()</code> takes name-value pairs where the name gives the name of the column in the output, and the value is a expression for what value to put in that column.</p>
<p>Let’s add a column that computes bill depth to length</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute bill depth proportional to length</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co">#very low means very long and thin beaks</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#high means short and stout beaks</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_depth_to_length =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 9
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;, bill_depth_to_length &lt;dbl&gt;</code></pre>
</div>
</div>
<p>To store the dataset with the new column, we need assign our new dataset to a variable.</p>
<p>In R, we use <code>&lt;-</code> to assign a value to a variable name (<code>=</code> is ok too for the purposes of this course).</p>
<p>So, to store the new column in our penguins dataset, we can just assign the new data frame to our <code>penguins</code> variable.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add the new column and store it in penguins</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_depth_to_length =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">#check out our new penguins data frame</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">#we have a new column!</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>penguins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 9
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 3 more variables: sex &lt;fct&gt;, year &lt;int&gt;, bill_depth_to_length &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="summarize" class="level3">
<h3 class="anchored" data-anchor-id="summarize">Summarize</h3>
<p>We sometimes want to summarize across multiple observations in describing our data. This is where <code>summarize()</code> comes in.</p>
<p>What <code>summarize()</code> does is to apply a function to a part of the dataset to create a new summary dataset.</p>
<p>For example, let’s redo our code computing the average bill length using <code>summarize()</code></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average bill length</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  avg_bill_length
            &lt;dbl&gt;
1            43.9</code></pre>
</div>
</div>
<p>We can create a dataset with multiple new summarized columns using <code>summarize()</code>.</p>
<p>For example, <code>n()</code> is a function that counts up all of the observations. So, we can also add a column with the total number of observations using the code below.</p>
<p><strong>Tip:</strong> each specifying how to compute a new column should be separated from the next using a comma.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_penguins =</span> <span class="fu">n</span>(),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  number_penguins avg_bill_length
            &lt;int&gt;           &lt;dbl&gt;
1             344            43.9</code></pre>
</div>
</div>
</section>
<section id="grouping-and-summarizing" class="level3">
<h3 class="anchored" data-anchor-id="grouping-and-summarizing">Grouping and summarizing</h3>
<p>Ok, is still a little boring. But these functions become very powerful once you bring in the concept of grouping using <code>group_by()</code>.</p>
<p><code>group_by()</code> adds a grouping marker to your dataset. Subsequent verbs like <code>summarize()</code> then use that grouping variable when performing their operation. So, concretely, summarize will apply its functions <em>by each data group</em>. Let’s see how this works in practice.</p>
<p>Let’s say I want to summarize the average bill length <em>for each penguin species</em>. This is now as simple as adding just one grouping, using <code>group_by()</code>, prior to summarizing:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize average bill length by group</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#notice that we are now counting the number of penguins by species too!</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_penguins =</span> <span class="fu">n</span>(),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  species   number_penguins avg_bill_length
  &lt;fct&gt;               &lt;int&gt;           &lt;dbl&gt;
1 Adelie                152            38.8
2 Chinstrap              68            48.8
3 Gentoo                124            47.5</code></pre>
</div>
</div>
<p>We can also apply multiple groupings in order to get data that is further nested. For example, to get a breakdown not only by species, but also by each island for each species, we can just add the <code>island</code> column to <code>group_by()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize by species AND island</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species,island) <span class="sc">|&gt;</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_penguins =</span> <span class="fu">n</span>(),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'species'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
# Groups:   species [3]
  species   island    number_penguins avg_bill_length
  &lt;fct&gt;     &lt;fct&gt;               &lt;int&gt;           &lt;dbl&gt;
1 Adelie    Biscoe                 44            39.0
2 Adelie    Dream                  56            38.5
3 Adelie    Torgersen              52            39.0
4 Chinstrap Dream                  68            48.8
5 Gentoo    Biscoe                124            47.5</code></pre>
</div>
</div>
<p>Turns out that only one penguin appears on all three islands - the other two were only observed on one island!</p>
</section>
<section id="finale" class="level3">
<h3 class="anchored" data-anchor-id="finale">Finale</h3>
<p>You’ve learned some of the most important tidyverse verbs!</p>
<p>To briefly give you a glimpse of why this can be so useful, here’s how you could apply these verbs to wrangle the data into shape for a cool plot.</p>
<p>Let’s create a barplot showing the average bill length, for each penguin species.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#barplot of average bill length, by penguin species</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>summarized_species_info <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">#create a simple bar plot</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summarized_species_info,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> avg_bill_length))<span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's make the plot fancier and add in the raw data points!</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summarized_species_info,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> avg_bill_length,<span class="at">color=</span>species))<span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">data=</span>penguins,<span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>penguins,<span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm),<span class="at">width=</span><span class="fl">0.1</span>,<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">size=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Bill Length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="working-with-experiment-data" class="level2">
<h2 class="anchored" data-anchor-id="working-with-experiment-data">4. Working with Experiment Data</h2>
<p>Now, let’s work with a (cleaned-up) version of the type of data you’ll be working with in your experiment.</p>
<p>This data is from <a href="https://drive.google.com/file/d/1kpNFFcPdA9XiL4jseJtnrE3gdUOWkg66/view?usp=drive_link">Zettersten &amp; Lupyan (2020)</a>.</p>
<p>In the experiment, participants figure out which of two categories (A or B) a given image belongs to through trial and error. Over time (24 trials, organized into three blocks of 8 trials each), they start to learn the category structure. The key manipulation is a between-subjects condition: in the high nameability condition, the features of the images (in this case, colors) are very easy to name (e.g., blue, orange). In the low nameability condition, the colors are very difficult to name (e.g., sienna, mauve). The finding is that categories were easier to learn when the color features were more nameable.</p>
<p>The data here presents the <strong>actual</strong> data from the first two experiments in the paper (1A and 1B). The experiments are structurally identical - they just use slightly different arrangements of colors.</p>
<section id="load-the-data" class="level3">
<h3 class="anchored" data-anchor-id="load-the-data">4.1. Load the data</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the data we'll use</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#data from: Zettersten &amp; Lupyan (2020)</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1kpNFFcPdA9XiL4jseJtnrE3gdUOWkg66/view?usp=drive_link</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>nameability_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/COGS119/tutorials/refs/heads/main/R/nameability_exercise.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2400 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): experiment, subject, condition, image_name
dbl (3): total_trial_num, block_num, is_right

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
</section>
<section id="understand-the-structure-of-the-data" class="level3">
<h3 class="anchored" data-anchor-id="understand-the-structure-of-the-data">4.2. Understand the structure of the data</h3>
<p>First, let’s understand how our data is structured. Here’s another way to take a first peek at your data.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>nameability_data <span class="sc">|&gt;</span> <span class="fu">View</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The data contains the following columns:</p>
<ul>
<li>experiment: the name of the experiment in the paper (1A or 1B)</li>
<li>subject: the unique participant id</li>
<li>condition: nameability condition (high or low)</li>
<li>total_trial_num: the trial number (1-24)</li>
<li>block_num: the block number (3 blocks of 8 trials each)</li>
<li>image_name: the name of the stimulus to be categorized</li>
<li>is_right: whether the response was correct (is_right=1) or incorrect (is_right=0)</li>
</ul>
<p>Is the data in tidy format? Why/ why not?</p>
</section>
<section id="summarize-the-data-from-experiment-1a" class="level3">
<h3 class="anchored" data-anchor-id="summarize-the-data-from-experiment-1a">4.3. Summarize the data from Experiment 1A</h3>
<p>Let’s summarize the average accuracy for each participant from Experiment 1A only, retaining information about which condition they were in.</p>
<p>Why is it important to first summarize the data by participant? (tip: non-independence of observations)</p>
<p>To do so, we need to:</p>
<ul>
<li><p>filter the data to Experiment 1A</p></li>
<li><p>group the data by condition (why?) and participant</p></li>
<li><p>summarize the average accuracy</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average accuracy for each participant for Experiment 1</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>subj_1a <span class="ot">&lt;-</span> nameability_data <span class="sc">|&gt;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(experiment <span class="sc">==</span> <span class="st">"1A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition,subject) <span class="sc">|&gt;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy=</span><span class="fu">mean</span>(is_right)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'condition'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>subj_1a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 3
# Groups:   condition [2]
   condition subject accuracy
   &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;
 1 high      p20905     0.958
 2 high      p213384    1    
 3 high      p299672    0.833
 4 high      p359420    0.833
 5 high      p382311    0.75 
 6 high      p382455    0.917
 7 high      p445288    0.667
 8 high      p454103    0.792
 9 high      p457572    0.917
10 high      p461893    0.833
# ℹ 40 more rows</code></pre>
</div>
</div>
</section>
<section id="plot-the-data" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-data">4.4. Plot the data</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(subj_1a, <span class="fu">aes</span>(condition,accuracy,<span class="at">color=</span>condition,<span class="at">fill=</span>condition))<span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_jitter()+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">"y"</span>,<span class="at">stackdir=</span><span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="more-advanced-summarizing" class="level3">
<h3 class="anchored" data-anchor-id="more-advanced-summarizing">4.5. More advanced summarizing</h3>
<p>What if I’m interested in how accuracy changes across blocks, again for Experiment 1A? Now, I can also group by <code>block_num</code>.</p>
<p>In the code below, why do I first group by <code>subject</code> and then by <code>block_num</code>?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>subj_block_1a <span class="ot">&lt;-</span> nameability_data <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(experiment <span class="sc">==</span> <span class="st">"1A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition,subject, block_num) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy=</span><span class="fu">mean</span>(is_right)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'condition', 'subject'. You can override
using the `.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>subj_block_1a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 4
# Groups:   condition, subject [50]
   condition subject block_num accuracy
   &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;
 1 high      p20905          1    0.875
 2 high      p20905          2    1    
 3 high      p20905          3    1    
 4 high      p213384         1    1    
 5 high      p213384         2    1    
 6 high      p213384         3    1    
 7 high      p299672         1    0.75 
 8 high      p299672         2    0.875
 9 high      p299672         3    0.875
10 high      p359420         1    0.625
# ℹ 140 more rows</code></pre>
</div>
</div>
<p>Finally, it would be helpful to use the participant-level compute the group-level means for each condition, along with error bars (to give a sense of variability).</p>
<p>Go through each line. Can you figure out what each one is doing?</p>
<p>Notes: we introduce a couple of new functions here:</p>
<ul>
<li><p><code>sd()</code>: computes the standard deviation</p></li>
<li><p><code>sqrt()</code>: computes the square root</p></li>
<li><p>we compute the standard error of the mean (<code>sem</code>) using the following formula: <span class="math inline">\(SEM = \frac{SD}{\sqrt{N}}\)</span></p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the overall group mean by condition and block</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">#also compute the standard error of the mean</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>group_means_1a <span class="ot">&lt;-</span> subj_block_1a <span class="sc">|&gt;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition,block_num) <span class="sc">|&gt;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_correct =</span> <span class="fu">mean</span>(accuracy),</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_correct =</span> <span class="fu">sd</span>(accuracy),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sem =</span> sd_correct <span class="sc">/</span> <span class="fu">sqrt</span>(n_obs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'condition'. You can override using the
`.groups` argument.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>group_means_1a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   condition [2]
  condition block_num mean_correct sd_correct n_obs    sem
  &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
1 high              1        0.75       0.169    25 0.0339
2 high              2        0.865      0.148    25 0.0297
3 high              3        0.905      0.154    25 0.0309
4 low               1        0.6        0.207    25 0.0415
5 low               2        0.695      0.234    25 0.0468
6 low               3        0.735      0.235    25 0.0469</code></pre>
</div>
</div>
<p>Let’s plot it!</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(group_means_1a,<span class="fu">aes</span>(block_num,mean_correct,<span class="at">color=</span>condition))<span class="sc">+</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_correct<span class="sc">-</span>sem,<span class="at">ymax=</span>mean_correct<span class="sc">+</span>sem),<span class="at">width=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Block Number"</span>)<span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Average Proportion Correct"</span>)<span class="sc">+</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_to_tidyverse_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb70" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Intro to Tidyverse"</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Wrangling with R</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>Today's goal is to get familiar with some of the basics of working with data using R's <span class="co">[</span><span class="ot">tidyverse</span><span class="co">](https://www.tidyverse.org/)</span> environment.</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>Tidyverse is a set of packages written for the statistical software R that is optimized for data science.</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>There are many components to the tidyverse, but we will focus on three packages in particular:</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Getting data into "tidy" format using <span class="in">`tidyr`</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Manipulating or "wrangling" data for analysis using <span class="in">`dplyr`</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Visualizing data using <span class="in">`ggplot2`</span></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>The overarching goal is to give you the basic tools for data exploration and visualization as quickly as possible.</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>The workflow and philosophy of how this works is captured in this figure from the excellent <span class="co">[</span><span class="ot">R for Data Science</span><span class="co">](https://r4ds.hadley.nz/)</span> book by Hadley Wickham (the main author of the tidyverse packages).</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>The goal of these packages is to give you the tools to:</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**import** your data for analysis</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>bring the data into a standard, consistent, **tidy** format</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**transform** the data according to your analysis needs</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**visualize** the data in the service of understanding it</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/data-science-explore.png)</span></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>Before beginning this tutorial, make sure to download R and RStudio.</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0. Setting Up: Loading the tidyverse packages</span></span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>This first part of the code just installs and loads the R packages we want to use for the following analyses.</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Install packages we want to use</span></span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a><span class="co">#specify the name of all packages we want to use her</span></span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("palmerpenguins")</span></span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a><span class="co">#load packages we want to use</span></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a><span class="co">#set some basic plotting defaults</span></span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>))</span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a><span class="co">#check the version of R used</span></span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(R.version.string)</span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. (Tidy) Data</span></span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a>Here's the basic idea behind "tidy" data.</span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>In "tidy" data,...</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a>... every row is a **single observation** (e.g., a trial in experiments)</span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a>... every column is a **variable** with a **value** describing that observation</span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/tidy-1.png)</span></span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a>For this first introduction, we will use Allison Horst's <span class="in">`palmerpenguins`</span> dataset: https://allisonhorst.github.io/palmerpenguins/</span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a>The dataset contains information about 344 penguins, from 3 different species of penguins that live on 3 islands in the Palmer Archipelago, Antarctica.</span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a>Here's a cute drawing of the three penguin species: Chinstrap, Gentoo and Adelie!</span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a>Let's load the data and take a peek!</span>
<span id="cb70-85"><a href="#cb70-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-88"><a href="#cb70-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-89"><a href="#cb70-89" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the data</span></span>
<span id="cb70-90"><a href="#cb70-90" aria-hidden="true" tabindex="-1"></a>penguins</span>
<span id="cb70-91"><a href="#cb70-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-92"><a href="#cb70-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-93"><a href="#cb70-93" aria-hidden="true" tabindex="-1"></a>That's a lot of data! To get a more manageable peek, you can use glimpse()</span>
<span id="cb70-94"><a href="#cb70-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-97"><a href="#cb70-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-98"><a href="#cb70-98" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(penguins)</span>
<span id="cb70-99"><a href="#cb70-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-100"><a href="#cb70-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-101"><a href="#cb70-101" aria-hidden="true" tabindex="-1"></a>Each row in the data represents the data from one penguin on one of the 3 islands. Let's think about what each of our columns means.</span>
<span id="cb70-102"><a href="#cb70-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-103"><a href="#cb70-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**species**: the species that the penguin belongs to (Chinstrap, Gentoo and Adelie)</span>
<span id="cb70-104"><a href="#cb70-104" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**island**: the island that the penguin lives on (Biscoe, Dream, Torgersen)</span>
<span id="cb70-105"><a href="#cb70-105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>information about the penguins' general size and dimensions:</span>
<span id="cb70-106"><a href="#cb70-106" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**bill_length_mm**: bill length in mm</span>
<span id="cb70-107"><a href="#cb70-107" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**bill_depth_mm**: bill depth in mm</span>
<span id="cb70-108"><a href="#cb70-108" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**flipper_length_mm**: flipper length in mm</span>
<span id="cb70-109"><a href="#cb70-109" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**body_mass_g**: body mass in grams</span>
<span id="cb70-110"><a href="#cb70-110" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**sex**: the sex of the penguin</span>
<span id="cb70-111"><a href="#cb70-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**year**: the year the penguin was observed</span>
<span id="cb70-112"><a href="#cb70-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-113"><a href="#cb70-113" aria-hidden="true" tabindex="-1"></a>This data is in tidy format!</span>
<span id="cb70-114"><a href="#cb70-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-115"><a href="#cb70-115" aria-hidden="true" tabindex="-1"></a>... every row corresponds to a single observation (of a penguin)</span>
<span id="cb70-116"><a href="#cb70-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-117"><a href="#cb70-117" aria-hidden="true" tabindex="-1"></a>... each column is a variable with a single value for each observation (penguin)</span>
<span id="cb70-118"><a href="#cb70-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-119"><a href="#cb70-119" aria-hidden="true" tabindex="-1"></a>One useful tip: an easy way to access individual columns in a data frame (or "tibble") is to use the \$ character. So, for example, to access all of the bill lengths we can do penguins\$bill_length_mm</span>
<span id="cb70-120"><a href="#cb70-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-123"><a href="#cb70-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-124"><a href="#cb70-124" aria-hidden="true" tabindex="-1"></a><span class="co">#access the bill length column</span></span>
<span id="cb70-125"><a href="#cb70-125" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>bill_depth_mm</span>
<span id="cb70-126"><a href="#cb70-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-127"><a href="#cb70-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-128"><a href="#cb70-128" aria-hidden="true" tabindex="-1"></a>To get a little bit excited, let's start out by diving right into visualization to flex our new powers. Don't worry too much about the details just yet. We'll explain some of the basics in more depth over the next few sessions. This is just to get a quick sense of why it might be cool to learn more about working with data in R.</span>
<span id="cb70-129"><a href="#cb70-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-130"><a href="#cb70-130" aria-hidden="true" tabindex="-1"></a>Let's say I want to do a scatterplot of bill length by bill depth. Creating that plot using ggplot in R is as simple as the following:</span>
<span id="cb70-131"><a href="#cb70-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-134"><a href="#cb70-134" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-135"><a href="#cb70-135" aria-hidden="true" tabindex="-1"></a><span class="co"># the ggplot call sets up the basic structure of the graph</span></span>
<span id="cb70-136"><a href="#cb70-136" aria-hidden="true" tabindex="-1"></a><span class="co"># first, we specify the dataset we want to use</span></span>
<span id="cb70-137"><a href="#cb70-137" aria-hidden="true" tabindex="-1"></a><span class="co"># then, we specify the key "aesthetics" with aes:</span></span>
<span id="cb70-138"><a href="#cb70-138" aria-hidden="true" tabindex="-1"></a><span class="co"># what's on x-axis? what's on the y-axis?</span></span>
<span id="cb70-139"><a href="#cb70-139" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm)) <span class="sc">+</span></span>
<span id="cb70-140"><a href="#cb70-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># different "geoms" define what type of structure we plot. In this case, we use geom_point() to plot individual dots for each observation</span></span>
<span id="cb70-141"><a href="#cb70-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-142"><a href="#cb70-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-143"><a href="#cb70-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-144"><a href="#cb70-144" aria-hidden="true" tabindex="-1"></a>Interesting!! Now, I know there are three species of penguin. Are there any systematicities in bill length and bill depth across them? To see, let's try to highlight the color of the dots for each species.</span>
<span id="cb70-145"><a href="#cb70-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-146"><a href="#cb70-146" aria-hidden="true" tabindex="-1"></a>**Advanced:** Why do you think we're getting the warning message we see?</span>
<span id="cb70-147"><a href="#cb70-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-150"><a href="#cb70-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-151"><a href="#cb70-151" aria-hidden="true" tabindex="-1"></a><span class="co"># add color, defined by the species column, to the aes() call</span></span>
<span id="cb70-152"><a href="#cb70-152" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color=</span>species)) <span class="sc">+</span></span>
<span id="cb70-153"><a href="#cb70-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb70-154"><a href="#cb70-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-155"><a href="#cb70-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-156"><a href="#cb70-156" aria-hidden="true" tabindex="-1"></a>Ooooh, now I see that there's something systematic happening here. Let's put some final touches on this graph so that it looks a bit better: <span class="sc">\*</span> Change the color scheme to something more attractive <span class="sc">\*</span> rename the axes for humans</span>
<span id="cb70-157"><a href="#cb70-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-160"><a href="#cb70-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-161"><a href="#cb70-161" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot example: penguin bill length versus bill depth</span></span>
<span id="cb70-162"><a href="#cb70-162" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> penguins, <span class="fu">aes</span>(<span class="at">x =</span> bill_length_mm, <span class="at">y =</span> bill_depth_mm, <span class="at">color=</span>species)) <span class="sc">+</span></span>
<span id="cb70-163"><a href="#cb70-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb70-164"><a href="#cb70-164" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change colors manually</span></span>
<span id="cb70-165"><a href="#cb70-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkorange"</span>,<span class="st">"darkorchid"</span>,<span class="st">"cyan4"</span>))<span class="sc">+</span></span>
<span id="cb70-166"><a href="#cb70-166" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename axes</span></span>
<span id="cb70-167"><a href="#cb70-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Bill Length (in mm)"</span>)<span class="sc">+</span></span>
<span id="cb70-168"><a href="#cb70-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Bill Depth (in mm)"</span>)</span>
<span id="cb70-169"><a href="#cb70-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-170"><a href="#cb70-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-171"><a href="#cb70-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Some coding basics</span></span>
<span id="cb70-172"><a href="#cb70-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-173"><a href="#cb70-173" aria-hidden="true" tabindex="-1"></a>To get warmed up, let's get familiar with two key concepts in R:</span>
<span id="cb70-174"><a href="#cb70-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-175"><a href="#cb70-175" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>functions</span>
<span id="cb70-176"><a href="#cb70-176" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>pipes</span>
<span id="cb70-177"><a href="#cb70-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-178"><a href="#cb70-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### Functions</span></span>
<span id="cb70-179"><a href="#cb70-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-180"><a href="#cb70-180" aria-hidden="true" tabindex="-1"></a>We'll start with the concept of a function.</span>
<span id="cb70-181"><a href="#cb70-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-182"><a href="#cb70-182" aria-hidden="true" tabindex="-1"></a>Just like in other programming languages, a function is a way to **do** something to a data object. It takes an argument (or a series of arguments) and returns a value.</span>
<span id="cb70-183"><a href="#cb70-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-184"><a href="#cb70-184" aria-hidden="true" tabindex="-1"></a>A nice example in R is <span class="in">`mean()`</span>. <span class="in">`mean()`</span> takes an argument, a numeric vector, and returns the average. <span class="in">`mean()`</span> also has a second argument, <span class="in">`na.rm=TRUE`</span>, that can tell it to ignore missing values (this is useful in our penguins dataset).</span>
<span id="cb70-185"><a href="#cb70-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-186"><a href="#cb70-186" aria-hidden="true" tabindex="-1"></a>So, to compute the average bill depth, we can write the following code:</span>
<span id="cb70-187"><a href="#cb70-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-190"><a href="#cb70-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-191"><a href="#cb70-191" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average bill depth</span></span>
<span id="cb70-192"><a href="#cb70-192" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(penguins<span class="sc">$</span>bill_depth_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-193"><a href="#cb70-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-194"><a href="#cb70-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-195"><a href="#cb70-195" aria-hidden="true" tabindex="-1"></a>Hmm, that's a lot of decimal places... It would be nice to clean this up a bit by rounding off after a few decimals. Conveniently, R provides a <span class="in">`round()`</span> function that does just that! (it takes a second argument, digits, that tells it how many decimal places to round to).</span>
<span id="cb70-196"><a href="#cb70-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-199"><a href="#cb70-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-200"><a href="#cb70-200" aria-hidden="true" tabindex="-1"></a><span class="co">#round the average value</span></span>
<span id="cb70-201"><a href="#cb70-201" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(penguins<span class="sc">$</span>bill_depth_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>),<span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb70-202"><a href="#cb70-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-203"><a href="#cb70-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-204"><a href="#cb70-204" aria-hidden="true" tabindex="-1"></a>While it's nice to be able to strong functions together this way, that line is already looking kind of complicated. Is there an easier way to apply functions sequentially, one after the other? We'll return to this in a moment.</span>
<span id="cb70-205"><a href="#cb70-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-206"><a href="#cb70-206" aria-hidden="true" tabindex="-1"></a>R supplies all sorts of functions that are useful for data analysis. For example, see if you can figure out how heavy the chonkiest penguin is.</span>
<span id="cb70-207"><a href="#cb70-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-208"><a href="#cb70-208" aria-hidden="true" tabindex="-1"></a>**Tip**: The function for the finding the maximum value of a list/vector in R is <span class="in">`max()`</span></span>
<span id="cb70-209"><a href="#cb70-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-210"><a href="#cb70-210" aria-hidden="true" tabindex="-1"></a>**Tip #2**: If you run into missing values, you can ignore them using the parameter <span class="in">`na.rm=TRUE`</span>. So <span class="in">`max(my_vector,na.rm=TRUE)`</span>.</span>
<span id="cb70-211"><a href="#cb70-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-214"><a href="#cb70-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-215"><a href="#cb70-215" aria-hidden="true" tabindex="-1"></a><span class="co">#Find the maximum weight in the body_mass_g column</span></span>
<span id="cb70-216"><a href="#cb70-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-217"><a href="#cb70-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-218"><a href="#cb70-218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pipes</span></span>
<span id="cb70-219"><a href="#cb70-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-220"><a href="#cb70-220" aria-hidden="true" tabindex="-1"></a>We already noticed that the code starts to look complicated once we have to start nesting functions, e.g. <span class="in">`round(mean(penguins$bill_depth_mm,na.rm=TRUE),digits=2)`</span>. This is pretty hard to read and figure out what's going on!</span>
<span id="cb70-221"><a href="#cb70-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-222"><a href="#cb70-222" aria-hidden="true" tabindex="-1"></a>This motivates the intuition behind why a **pipe** operator <span class="in">`|&gt;`</span> (or alternatively <span class="in">`%&gt;%`</span>) is useful.</span>
<span id="cb70-223"><a href="#cb70-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-224"><a href="#cb70-224" aria-hidden="true" tabindex="-1"></a>Pipes are just a way of bringing the main argument we supply to a function to the front of the operation. For example, to compute the mean of bill depth, we can write the following instead, using the pipe operator:</span>
<span id="cb70-225"><a href="#cb70-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-228"><a href="#cb70-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-229"><a href="#cb70-229" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the mean using a pipe</span></span>
<span id="cb70-230"><a href="#cb70-230" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>bill_depth_mm <span class="sc">|&gt;</span></span>
<span id="cb70-231"><a href="#cb70-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-232"><a href="#cb70-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-233"><a href="#cb70-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-234"><a href="#cb70-234" aria-hidden="true" tabindex="-1"></a>This allows us to string functions together - basic as many as we want - in the order that we would like to do them. What's nice about this is that it makes the code much more legible, and it allows us to write the code in their intuitive order.</span>
<span id="cb70-235"><a href="#cb70-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-236"><a href="#cb70-236" aria-hidden="true" tabindex="-1"></a>For example, rather than having to write the nested code above, where the <span class="in">`mean()`</span> function is nested within the <span class="in">`round()`</span> function, we can use the pipe operator to write the sequence of operations out in order, for much cleaner code - we can just read off the sequence of actions we're performing, in order!</span>
<span id="cb70-237"><a href="#cb70-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-240"><a href="#cb70-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-241"><a href="#cb70-241" aria-hidden="true" tabindex="-1"></a>penguins<span class="sc">$</span>bill_depth_mm <span class="sc">|&gt;</span></span>
<span id="cb70-242"><a href="#cb70-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-243"><a href="#cb70-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb70-244"><a href="#cb70-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-245"><a href="#cb70-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-246"><a href="#cb70-246" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Working with Data: Some key tidyverse verbs</span></span>
<span id="cb70-247"><a href="#cb70-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-248"><a href="#cb70-248" aria-hidden="true" tabindex="-1"></a>In this section, we're going to become familiar with some of the key tidyverse "verbs": tidyverse functions for quickly and easily manipulating ("wrangling") data.</span>
<span id="cb70-249"><a href="#cb70-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-250"><a href="#cb70-250" aria-hidden="true" tabindex="-1"></a>There are many of these functions, but for know, we'll get to know the following key verbs:</span>
<span id="cb70-251"><a href="#cb70-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-252"><a href="#cb70-252" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`pull()`</span></span>
<span id="cb70-253"><a href="#cb70-253" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`filter()`</span></span>
<span id="cb70-254"><a href="#cb70-254" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`mutate()`</span></span>
<span id="cb70-255"><a href="#cb70-255" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`summarize()`</span></span>
<span id="cb70-256"><a href="#cb70-256" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`group_by()`</span></span>
<span id="cb70-257"><a href="#cb70-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-258"><a href="#cb70-258" aria-hidden="true" tabindex="-1"></a>**NOTE:** Tidyverse functions often have very intuitive names, but always be sure to check and make sure you understand what they do by reading the documentation!</span>
<span id="cb70-259"><a href="#cb70-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-260"><a href="#cb70-260" aria-hidden="true" tabindex="-1"></a>You can always get help on a given function by typing <span class="in">`?function_name`</span> (e.g., <span class="in">`?pull`</span>).</span>
<span id="cb70-261"><a href="#cb70-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-262"><a href="#cb70-262" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pull</span></span>
<span id="cb70-263"><a href="#cb70-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-264"><a href="#cb70-264" aria-hidden="true" tabindex="-1"></a>Let's get to know our first verb: <span class="in">`pull()`</span>.</span>
<span id="cb70-265"><a href="#cb70-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-266"><a href="#cb70-266" aria-hidden="true" tabindex="-1"></a>See its documentation <span class="co">[</span><span class="ot">here</span><span class="co">](https://dplyr.tidyverse.org/reference/pull.html)</span>.</span>
<span id="cb70-267"><a href="#cb70-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-268"><a href="#cb70-268" aria-hidden="true" tabindex="-1"></a>This verb allows us to "pull" the data from specific columns in our dataset - so it provides an alternative to using the <span class="in">`$`</span> operator. So, an alternative way to access a column in the penguins dataset is given below.</span>
<span id="cb70-269"><a href="#cb70-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-272"><a href="#cb70-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-273"><a href="#cb70-273" aria-hidden="true" tabindex="-1"></a><span class="co">#first, read more about pull</span></span>
<span id="cb70-274"><a href="#cb70-274" aria-hidden="true" tabindex="-1"></a>?pull</span>
<span id="cb70-275"><a href="#cb70-275" aria-hidden="true" tabindex="-1"></a><span class="co">#now, pull data from the bill depth column</span></span>
<span id="cb70-276"><a href="#cb70-276" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-277"><a href="#cb70-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_depth_mm)</span>
<span id="cb70-278"><a href="#cb70-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-279"><a href="#cb70-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-280"><a href="#cb70-280" aria-hidden="true" tabindex="-1"></a>Note that we can now rewrite the code above computing the (rounded) mean to go "full tidyverse", using only tidyverse functions and concatenating the functions using the pipe operator. Can you figure out how?</span>
<span id="cb70-281"><a href="#cb70-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-284"><a href="#cb70-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-285"><a href="#cb70-285" aria-hidden="true" tabindex="-1"></a><span class="co">#take the penguin dataset</span></span>
<span id="cb70-286"><a href="#cb70-286" aria-hidden="true" tabindex="-1"></a><span class="co">#pull the bill depth column</span></span>
<span id="cb70-287"><a href="#cb70-287" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the mean, and</span></span>
<span id="cb70-288"><a href="#cb70-288" aria-hidden="true" tabindex="-1"></a><span class="co">#round to 2 decimal places</span></span>
<span id="cb70-289"><a href="#cb70-289" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-290"><a href="#cb70-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_depth_mm) <span class="sc">|&gt;</span></span>
<span id="cb70-291"><a href="#cb70-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-292"><a href="#cb70-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb70-293"><a href="#cb70-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-294"><a href="#cb70-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-295"><a href="#cb70-295" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filter</span></span>
<span id="cb70-296"><a href="#cb70-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-297"><a href="#cb70-297" aria-hidden="true" tabindex="-1"></a>OK, let's learn something new.</span>
<span id="cb70-298"><a href="#cb70-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-299"><a href="#cb70-299" aria-hidden="true" tabindex="-1"></a>There are lots of reasons you might want to remove rows from your dataset, including getting rid of outliers, selecting subpopulations, and so forth. For this purpose, <span class="in">`filter()`</span> is a verb (a function in the tidyverse) that takes a data frame as its first argument, and then as its other argument(s) takes the condition(s) you want to filter on.</span>
<span id="cb70-300"><a href="#cb70-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-301"><a href="#cb70-301" aria-hidden="true" tabindex="-1"></a>For example, if we want to just look at the data for those cute Chinstrap penguins, we can do</span>
<span id="cb70-302"><a href="#cb70-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-305"><a href="#cb70-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-306"><a href="#cb70-306" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-307"><a href="#cb70-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Chinstrap"</span>)</span>
<span id="cb70-308"><a href="#cb70-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-309"><a href="#cb70-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-310"><a href="#cb70-310" aria-hidden="true" tabindex="-1"></a>We can also specify multiple filtering conditions. For example, if we wanted to look at only the Chinstrap penguins that weigh more than 4000g, we could write:</span>
<span id="cb70-311"><a href="#cb70-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-314"><a href="#cb70-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-315"><a href="#cb70-315" aria-hidden="true" tabindex="-1"></a><span class="co">#select only Chinstrap penguins &gt; 4000g</span></span>
<span id="cb70-316"><a href="#cb70-316" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-317"><a href="#cb70-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Chinstrap"</span>,body_mass_g<span class="sc">&gt;</span><span class="dv">4000</span>)</span>
<span id="cb70-318"><a href="#cb70-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-319"><a href="#cb70-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-320"><a href="#cb70-320" aria-hidden="true" tabindex="-1"></a>Mini exercises:</span>
<span id="cb70-321"><a href="#cb70-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-322"><a href="#cb70-322" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Can you filter the data to all of the male Gentoo penguins?</span>
<span id="cb70-323"><a href="#cb70-323" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Can you compute the average bill length of Adelie penguins?</span>
<span id="cb70-324"><a href="#cb70-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-327"><a href="#cb70-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-328"><a href="#cb70-328" aria-hidden="true" tabindex="-1"></a><span class="co">#filter to only male Gentoo penguins</span></span>
<span id="cb70-329"><a href="#cb70-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-330"><a href="#cb70-330" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average bill length of Adelie penguins</span></span>
<span id="cb70-331"><a href="#cb70-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-332"><a href="#cb70-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-333"><a href="#cb70-333" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mutate</span></span>
<span id="cb70-334"><a href="#cb70-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-335"><a href="#cb70-335" aria-hidden="true" tabindex="-1"></a>Adding columns to data frames is usually done to compute some kind of derived variable. <span class="in">`mutate()`</span> is the verb for these situations – it allows you to add a column to your dataset (or change one that already exists).</span>
<span id="cb70-336"><a href="#cb70-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-337"><a href="#cb70-337" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> takes name-value pairs where the name gives the name of the column in the output, and the value is a expression for what value to put in that column.</span>
<span id="cb70-338"><a href="#cb70-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-339"><a href="#cb70-339" aria-hidden="true" tabindex="-1"></a>Let's add a column that computes bill depth to length</span>
<span id="cb70-340"><a href="#cb70-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-343"><a href="#cb70-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-344"><a href="#cb70-344" aria-hidden="true" tabindex="-1"></a><span class="co">#compute bill depth proportional to length</span></span>
<span id="cb70-345"><a href="#cb70-345" aria-hidden="true" tabindex="-1"></a><span class="co">#very low means very long and thin beaks</span></span>
<span id="cb70-346"><a href="#cb70-346" aria-hidden="true" tabindex="-1"></a><span class="co">#high means short and stout beaks</span></span>
<span id="cb70-347"><a href="#cb70-347" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-348"><a href="#cb70-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_depth_to_length =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm)</span>
<span id="cb70-349"><a href="#cb70-349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-350"><a href="#cb70-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-351"><a href="#cb70-351" aria-hidden="true" tabindex="-1"></a>To store the dataset with the new column, we need assign our new dataset to a variable.</span>
<span id="cb70-352"><a href="#cb70-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-353"><a href="#cb70-353" aria-hidden="true" tabindex="-1"></a>In R, we use <span class="in">`&lt;-`</span> to assign a value to a variable name (<span class="in">`=`</span> is ok too for the purposes of this course).</span>
<span id="cb70-354"><a href="#cb70-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-355"><a href="#cb70-355" aria-hidden="true" tabindex="-1"></a>So, to store the new column in our penguins dataset, we can just assign the new data frame to our <span class="in">`penguins`</span> variable.</span>
<span id="cb70-356"><a href="#cb70-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-359"><a href="#cb70-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-360"><a href="#cb70-360" aria-hidden="true" tabindex="-1"></a><span class="co">#add the new column and store it in penguins</span></span>
<span id="cb70-361"><a href="#cb70-361" aria-hidden="true" tabindex="-1"></a>penguins <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb70-362"><a href="#cb70-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bill_depth_to_length =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm)</span>
<span id="cb70-363"><a href="#cb70-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-364"><a href="#cb70-364" aria-hidden="true" tabindex="-1"></a><span class="co">#check out our new penguins data frame</span></span>
<span id="cb70-365"><a href="#cb70-365" aria-hidden="true" tabindex="-1"></a><span class="co">#we have a new column!</span></span>
<span id="cb70-366"><a href="#cb70-366" aria-hidden="true" tabindex="-1"></a>penguins</span>
<span id="cb70-367"><a href="#cb70-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-368"><a href="#cb70-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-369"><a href="#cb70-369" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summarize</span></span>
<span id="cb70-370"><a href="#cb70-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-371"><a href="#cb70-371" aria-hidden="true" tabindex="-1"></a>We sometimes want to summarize across multiple observations in describing our data. This is where <span class="in">`summarize()`</span> comes in.</span>
<span id="cb70-372"><a href="#cb70-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-373"><a href="#cb70-373" aria-hidden="true" tabindex="-1"></a>What <span class="in">`summarize()`</span> does is to apply a function to a part of the dataset to create a new summary dataset.</span>
<span id="cb70-374"><a href="#cb70-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-375"><a href="#cb70-375" aria-hidden="true" tabindex="-1"></a>For example, let's redo our code computing the average bill length using <span class="in">`summarize()`</span></span>
<span id="cb70-376"><a href="#cb70-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-379"><a href="#cb70-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-380"><a href="#cb70-380" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average bill length</span></span>
<span id="cb70-381"><a href="#cb70-381" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-382"><a href="#cb70-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb70-383"><a href="#cb70-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-384"><a href="#cb70-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-385"><a href="#cb70-385" aria-hidden="true" tabindex="-1"></a>We can create a dataset with multiple new summarized columns using <span class="in">`summarize()`</span>.</span>
<span id="cb70-386"><a href="#cb70-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-387"><a href="#cb70-387" aria-hidden="true" tabindex="-1"></a>For example, <span class="in">`n()`</span> is a function that counts up all of the observations. So, we can also add a column with the total number of observations using the code below.</span>
<span id="cb70-388"><a href="#cb70-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-389"><a href="#cb70-389" aria-hidden="true" tabindex="-1"></a>**Tip:** each specifying how to compute a new column should be separated from the next using a comma.</span>
<span id="cb70-390"><a href="#cb70-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-393"><a href="#cb70-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-394"><a href="#cb70-394" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-395"><a href="#cb70-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-396"><a href="#cb70-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_penguins =</span> <span class="fu">n</span>(),</span>
<span id="cb70-397"><a href="#cb70-397" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-398"><a href="#cb70-398" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-399"><a href="#cb70-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-400"><a href="#cb70-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-401"><a href="#cb70-401" aria-hidden="true" tabindex="-1"></a><span class="fu">### Grouping and summarizing</span></span>
<span id="cb70-402"><a href="#cb70-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-403"><a href="#cb70-403" aria-hidden="true" tabindex="-1"></a>Ok, is still a little boring. But these functions become very powerful once you bring in the concept of grouping using <span class="in">`group_by()`</span>.</span>
<span id="cb70-404"><a href="#cb70-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-405"><a href="#cb70-405" aria-hidden="true" tabindex="-1"></a><span class="in">`group_by()`</span> adds a grouping marker to your dataset. Subsequent verbs like <span class="in">`summarize()`</span> then use that grouping variable when performing their operation. So, concretely, summarize will apply its functions *by each data group*. Let's see how this works in practice.</span>
<span id="cb70-406"><a href="#cb70-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-407"><a href="#cb70-407" aria-hidden="true" tabindex="-1"></a>Let's say I want to summarize the average bill length *for each penguin species*. This is now as simple as adding just one grouping, using <span class="in">`group_by()`</span>, prior to summarizing:</span>
<span id="cb70-408"><a href="#cb70-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-411"><a href="#cb70-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-412"><a href="#cb70-412" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize average bill length by group</span></span>
<span id="cb70-413"><a href="#cb70-413" aria-hidden="true" tabindex="-1"></a><span class="co">#notice that we are now counting the number of penguins by species too!</span></span>
<span id="cb70-414"><a href="#cb70-414" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-415"><a href="#cb70-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb70-416"><a href="#cb70-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-417"><a href="#cb70-417" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_penguins =</span> <span class="fu">n</span>(),</span>
<span id="cb70-418"><a href="#cb70-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-419"><a href="#cb70-419" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-420"><a href="#cb70-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-421"><a href="#cb70-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-422"><a href="#cb70-422" aria-hidden="true" tabindex="-1"></a>We can also apply multiple groupings in order to get data that is further nested. For example, to get a breakdown not only by species, but also by each island for each species, we can just add the <span class="in">`island`</span> column to <span class="in">`group_by()`</span>.</span>
<span id="cb70-423"><a href="#cb70-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-426"><a href="#cb70-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-427"><a href="#cb70-427" aria-hidden="true" tabindex="-1"></a><span class="co">#summarize by species AND island</span></span>
<span id="cb70-428"><a href="#cb70-428" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="cb70-429"><a href="#cb70-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species,island) <span class="sc">|&gt;</span></span>
<span id="cb70-430"><a href="#cb70-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-431"><a href="#cb70-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_penguins =</span> <span class="fu">n</span>(),</span>
<span id="cb70-432"><a href="#cb70-432" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-433"><a href="#cb70-433" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-434"><a href="#cb70-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-435"><a href="#cb70-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-436"><a href="#cb70-436" aria-hidden="true" tabindex="-1"></a>Turns out that only one penguin appears on all three islands - the other two were only observed on one island!</span>
<span id="cb70-437"><a href="#cb70-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-438"><a href="#cb70-438" aria-hidden="true" tabindex="-1"></a><span class="fu">### Finale</span></span>
<span id="cb70-439"><a href="#cb70-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-440"><a href="#cb70-440" aria-hidden="true" tabindex="-1"></a>You've learned some of the most important tidyverse verbs!</span>
<span id="cb70-441"><a href="#cb70-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-442"><a href="#cb70-442" aria-hidden="true" tabindex="-1"></a>To briefly give you a glimpse of why this can be so useful, here's how you could apply these verbs to wrangle the data into shape for a cool plot.</span>
<span id="cb70-443"><a href="#cb70-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-444"><a href="#cb70-444" aria-hidden="true" tabindex="-1"></a>Let's create a barplot showing the average bill length, for each penguin species.</span>
<span id="cb70-445"><a href="#cb70-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-448"><a href="#cb70-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-449"><a href="#cb70-449" aria-hidden="true" tabindex="-1"></a><span class="co">#barplot of average bill length, by penguin species</span></span>
<span id="cb70-450"><a href="#cb70-450" aria-hidden="true" tabindex="-1"></a>summarized_species_info <span class="ot">&lt;-</span> penguins <span class="sc">|&gt;</span></span>
<span id="cb70-451"><a href="#cb70-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">|&gt;</span></span>
<span id="cb70-452"><a href="#cb70-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-453"><a href="#cb70-453" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_bill_length =</span> <span class="fu">mean</span>(bill_length_mm,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb70-454"><a href="#cb70-454" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-455"><a href="#cb70-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-456"><a href="#cb70-456" aria-hidden="true" tabindex="-1"></a><span class="co">#create a simple bar plot</span></span>
<span id="cb70-457"><a href="#cb70-457" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summarized_species_info,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> avg_bill_length))<span class="sc">+</span></span>
<span id="cb70-458"><a href="#cb70-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)</span>
<span id="cb70-459"><a href="#cb70-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-460"><a href="#cb70-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-463"><a href="#cb70-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-464"><a href="#cb70-464" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's make the plot fancier and add in the raw data points!</span></span>
<span id="cb70-465"><a href="#cb70-465" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summarized_species_info,<span class="fu">aes</span>(<span class="at">x =</span> species, <span class="at">y =</span> avg_bill_length,<span class="at">color=</span>species))<span class="sc">+</span></span>
<span id="cb70-466"><a href="#cb70-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">data=</span>penguins,<span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm)) <span class="sc">+</span></span>
<span id="cb70-467"><a href="#cb70-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>penguins,<span class="fu">aes</span>(<span class="at">y =</span> bill_length_mm),<span class="at">width=</span><span class="fl">0.1</span>,<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb70-468"><a href="#cb70-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">fill=</span><span class="cn">NA</span>,<span class="at">size=</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb70-469"><a href="#cb70-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Bill Length (mm)"</span>)<span class="sc">+</span></span>
<span id="cb70-470"><a href="#cb70-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>)</span>
<span id="cb70-471"><a href="#cb70-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-472"><a href="#cb70-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-473"><a href="#cb70-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Working with Experiment Data</span></span>
<span id="cb70-474"><a href="#cb70-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-475"><a href="#cb70-475" aria-hidden="true" tabindex="-1"></a>Now, let's work with a (cleaned-up) version of the type of data you'll be working with in your experiment.</span>
<span id="cb70-476"><a href="#cb70-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-477"><a href="#cb70-477" aria-hidden="true" tabindex="-1"></a>This data is from <span class="co">[</span><span class="ot">Zettersten &amp; Lupyan (2020)</span><span class="co">](https://drive.google.com/file/d/1kpNFFcPdA9XiL4jseJtnrE3gdUOWkg66/view?usp=drive_link)</span>.</span>
<span id="cb70-478"><a href="#cb70-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-479"><a href="#cb70-479" aria-hidden="true" tabindex="-1"></a>In the experiment, participants figure out which of two categories (A or B) a given image belongs to through trial and error. Over time (24 trials, organized into three blocks of 8 trials each), they start to learn the category structure. The key manipulation is a between-subjects condition: in the high nameability condition, the features of the images (in this case, colors) are very easy to name (e.g., blue, orange). In the low nameability condition, the colors are very difficult to name (e.g., sienna, mauve). The finding is that categories were easier to learn when the color features were more nameable.</span>
<span id="cb70-480"><a href="#cb70-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-481"><a href="#cb70-481" aria-hidden="true" tabindex="-1"></a>The data here presents the **actual** data from the first two experiments in the paper (1A and 1B). The experiments are structurally identical - they just use slightly different arrangements of colors.</span>
<span id="cb70-482"><a href="#cb70-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-483"><a href="#cb70-483" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1. Load the data</span></span>
<span id="cb70-484"><a href="#cb70-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-487"><a href="#cb70-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-488"><a href="#cb70-488" aria-hidden="true" tabindex="-1"></a><span class="co">#read in the data we'll use</span></span>
<span id="cb70-489"><a href="#cb70-489" aria-hidden="true" tabindex="-1"></a><span class="co">#data from: Zettersten &amp; Lupyan (2020)</span></span>
<span id="cb70-490"><a href="#cb70-490" aria-hidden="true" tabindex="-1"></a><span class="co">#https://drive.google.com/file/d/1kpNFFcPdA9XiL4jseJtnrE3gdUOWkg66/view?usp=drive_link</span></span>
<span id="cb70-491"><a href="#cb70-491" aria-hidden="true" tabindex="-1"></a>nameability_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/COGS119/tutorials/refs/heads/main/R/nameability_exercise.csv"</span>)</span>
<span id="cb70-492"><a href="#cb70-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-493"><a href="#cb70-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-494"><a href="#cb70-494" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2. Understand the structure of the data</span></span>
<span id="cb70-495"><a href="#cb70-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-496"><a href="#cb70-496" aria-hidden="true" tabindex="-1"></a>First, let's understand how our data is structured. Here's another way to take a first peek at your data.</span>
<span id="cb70-497"><a href="#cb70-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-500"><a href="#cb70-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-501"><a href="#cb70-501" aria-hidden="true" tabindex="-1"></a>nameability_data <span class="sc">|&gt;</span> <span class="fu">View</span>()</span>
<span id="cb70-502"><a href="#cb70-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-503"><a href="#cb70-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-504"><a href="#cb70-504" aria-hidden="true" tabindex="-1"></a>The data contains the following columns:</span>
<span id="cb70-505"><a href="#cb70-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-506"><a href="#cb70-506" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>experiment: the name of the experiment in the paper (1A or 1B)</span>
<span id="cb70-507"><a href="#cb70-507" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>subject: the unique participant id</span>
<span id="cb70-508"><a href="#cb70-508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>condition: nameability condition (high or low)</span>
<span id="cb70-509"><a href="#cb70-509" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>total_trial_num: the trial number (1-24)</span>
<span id="cb70-510"><a href="#cb70-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>block_num: the block number (3 blocks of 8 trials each)</span>
<span id="cb70-511"><a href="#cb70-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>image_name: the name of the stimulus to be categorized</span>
<span id="cb70-512"><a href="#cb70-512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>is_right: whether the response was correct (is_right=1) or incorrect (is_right=0)</span>
<span id="cb70-513"><a href="#cb70-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-514"><a href="#cb70-514" aria-hidden="true" tabindex="-1"></a>Is the data in tidy format? Why/ why not?</span>
<span id="cb70-515"><a href="#cb70-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-516"><a href="#cb70-516" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.3. Summarize the data from Experiment 1A</span></span>
<span id="cb70-517"><a href="#cb70-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-518"><a href="#cb70-518" aria-hidden="true" tabindex="-1"></a>Let's summarize the average accuracy for each participant from Experiment 1A only, retaining information about which condition they were in.</span>
<span id="cb70-519"><a href="#cb70-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-520"><a href="#cb70-520" aria-hidden="true" tabindex="-1"></a>Why is it important to first summarize the data by participant? (tip: non-independence of observations)</span>
<span id="cb70-521"><a href="#cb70-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-522"><a href="#cb70-522" aria-hidden="true" tabindex="-1"></a>To do so, we need to:</span>
<span id="cb70-523"><a href="#cb70-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-524"><a href="#cb70-524" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>filter the data to Experiment 1A</span>
<span id="cb70-525"><a href="#cb70-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-526"><a href="#cb70-526" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>group the data by condition (why?) and participant</span>
<span id="cb70-527"><a href="#cb70-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-528"><a href="#cb70-528" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>summarize the average accuracy</span>
<span id="cb70-529"><a href="#cb70-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-532"><a href="#cb70-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-533"><a href="#cb70-533" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the average accuracy for each participant for Experiment 1</span></span>
<span id="cb70-534"><a href="#cb70-534" aria-hidden="true" tabindex="-1"></a>subj_1a <span class="ot">&lt;-</span> nameability_data <span class="sc">|&gt;</span></span>
<span id="cb70-535"><a href="#cb70-535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(experiment <span class="sc">==</span> <span class="st">"1A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-536"><a href="#cb70-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition,subject) <span class="sc">|&gt;</span></span>
<span id="cb70-537"><a href="#cb70-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-538"><a href="#cb70-538" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy=</span><span class="fu">mean</span>(is_right)</span>
<span id="cb70-539"><a href="#cb70-539" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-540"><a href="#cb70-540" aria-hidden="true" tabindex="-1"></a>subj_1a</span>
<span id="cb70-541"><a href="#cb70-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-542"><a href="#cb70-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-543"><a href="#cb70-543" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.4. Plot the data</span></span>
<span id="cb70-544"><a href="#cb70-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-547"><a href="#cb70-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-548"><a href="#cb70-548" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(subj_1a, <span class="fu">aes</span>(condition,accuracy,<span class="at">color=</span>condition,<span class="at">fill=</span>condition))<span class="sc">+</span></span>
<span id="cb70-549"><a href="#cb70-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill=</span><span class="cn">NA</span>)<span class="sc">+</span></span>
<span id="cb70-550"><a href="#cb70-550" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_jitter()+</span></span>
<span id="cb70-551"><a href="#cb70-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis=</span><span class="st">"y"</span>,<span class="at">stackdir=</span><span class="st">"center"</span>)</span>
<span id="cb70-552"><a href="#cb70-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-553"><a href="#cb70-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-554"><a href="#cb70-554" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.5. More advanced summarizing</span></span>
<span id="cb70-555"><a href="#cb70-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-556"><a href="#cb70-556" aria-hidden="true" tabindex="-1"></a>What if I'm interested in how accuracy changes across blocks, again for Experiment 1A? Now, I can also group by <span class="in">`block_num`</span>.</span>
<span id="cb70-557"><a href="#cb70-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-558"><a href="#cb70-558" aria-hidden="true" tabindex="-1"></a>In the code below, why do I first group by <span class="in">`subject`</span> and then by <span class="in">`block_num`</span>?</span>
<span id="cb70-559"><a href="#cb70-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-562"><a href="#cb70-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-563"><a href="#cb70-563" aria-hidden="true" tabindex="-1"></a>subj_block_1a <span class="ot">&lt;-</span> nameability_data <span class="sc">|&gt;</span></span>
<span id="cb70-564"><a href="#cb70-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(experiment <span class="sc">==</span> <span class="st">"1A"</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-565"><a href="#cb70-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition,subject, block_num) <span class="sc">|&gt;</span></span>
<span id="cb70-566"><a href="#cb70-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb70-567"><a href="#cb70-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy=</span><span class="fu">mean</span>(is_right)</span>
<span id="cb70-568"><a href="#cb70-568" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb70-569"><a href="#cb70-569" aria-hidden="true" tabindex="-1"></a>subj_block_1a</span>
<span id="cb70-570"><a href="#cb70-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-571"><a href="#cb70-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-572"><a href="#cb70-572" aria-hidden="true" tabindex="-1"></a>Finally, it would be helpful to use the participant-level compute the group-level means for each condition, along with error bars (to give a sense of variability).</span>
<span id="cb70-573"><a href="#cb70-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-574"><a href="#cb70-574" aria-hidden="true" tabindex="-1"></a>Go through each line. Can you figure out what each one is doing?</span>
<span id="cb70-575"><a href="#cb70-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-576"><a href="#cb70-576" aria-hidden="true" tabindex="-1"></a>Notes: we introduce a couple of new functions here:</span>
<span id="cb70-577"><a href="#cb70-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-578"><a href="#cb70-578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sd()`</span>: computes the standard deviation</span>
<span id="cb70-579"><a href="#cb70-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-580"><a href="#cb70-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`sqrt()`</span>: computes the square root</span>
<span id="cb70-581"><a href="#cb70-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-582"><a href="#cb70-582" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>we compute the standard error of the mean (<span class="in">`sem`</span>) using the following formula: $SEM = \frac{SD}{\sqrt{N}}$</span>
<span id="cb70-583"><a href="#cb70-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-586"><a href="#cb70-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-587"><a href="#cb70-587" aria-hidden="true" tabindex="-1"></a><span class="co">#compute the overall group mean by condition and block</span></span>
<span id="cb70-588"><a href="#cb70-588" aria-hidden="true" tabindex="-1"></a><span class="co">#also compute the standard error of the mean</span></span>
<span id="cb70-589"><a href="#cb70-589" aria-hidden="true" tabindex="-1"></a>group_means_1a <span class="ot">&lt;-</span> subj_block_1a <span class="sc">|&gt;</span></span>
<span id="cb70-590"><a href="#cb70-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(condition,block_num) <span class="sc">|&gt;</span></span>
<span id="cb70-591"><a href="#cb70-591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_correct =</span> <span class="fu">mean</span>(accuracy),</span>
<span id="cb70-592"><a href="#cb70-592" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_correct =</span> <span class="fu">sd</span>(accuracy),</span>
<span id="cb70-593"><a href="#cb70-593" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_obs =</span> <span class="fu">n</span>(),</span>
<span id="cb70-594"><a href="#cb70-594" aria-hidden="true" tabindex="-1"></a>            <span class="at">sem =</span> sd_correct <span class="sc">/</span> <span class="fu">sqrt</span>(n_obs))</span>
<span id="cb70-595"><a href="#cb70-595" aria-hidden="true" tabindex="-1"></a>group_means_1a</span>
<span id="cb70-596"><a href="#cb70-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb70-597"><a href="#cb70-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-598"><a href="#cb70-598" aria-hidden="true" tabindex="-1"></a>Let's plot it!</span>
<span id="cb70-599"><a href="#cb70-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-602"><a href="#cb70-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb70-603"><a href="#cb70-603" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(group_means_1a,<span class="fu">aes</span>(block_num,mean_correct,<span class="at">color=</span>condition))<span class="sc">+</span></span>
<span id="cb70-604"><a href="#cb70-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_correct<span class="sc">-</span>sem,<span class="at">ymax=</span>mean_correct<span class="sc">+</span>sem),<span class="at">width=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb70-605"><a href="#cb70-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb70-606"><a href="#cb70-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb70-607"><a href="#cb70-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Block Number"</span>)<span class="sc">+</span></span>
<span id="cb70-608"><a href="#cb70-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Average Proportion Correct"</span>)<span class="sc">+</span></span>
<span id="cb70-609"><a href="#cb70-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb70-610"><a href="#cb70-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>